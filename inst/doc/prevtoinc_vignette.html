<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Niklas Willrich" />

<meta name="date" content="2019-06-18" />

<title>Overview of the prevtoinc package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Overview of the prevtoinc package</h1>
<h4 class="author">Niklas Willrich</h4>
<h4 class="date">2019-06-18</h4>



<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(prevtoinc)</code></pre></div>
<p>This package implements functions to convert prevalence to incidence based on data obtained in point-prevalence studies (PPSs) along the lines of <span class="citation">(Rhame and Sudderth 1981)</span>,<span class="citation">(Freeman and Hutchison 1980)</span> and is a companion to an upcoming paper <span class="citation">(Willrich et al. 2019)</span>. It also implements methods to simulate PPS-data to benchmark different estimation methods. Notation will follow the companion paper. So a good idea is to read the paper first and afterwards the vignette.</p>
<div id="the-basic-structure-of-the-package" class="section level1">
<h1>The basic structure of the package</h1>
<p>The package has functions to simulate PPS-data based on distributions of length of infection and length of stay. Results of PPS simulations and incidence calculations are stored as tibbles. The functionality in the package can be divided in three parts:</p>
<ul>
<li>functions for PPS simulation,</li>
<li>functions to estimate incidence from PPS data,</li>
<li>helper functions dealing with length-biased distributions and monotone smoothing.</li>
</ul>
<p>In the following sections, we will go through these different aspects, starting with simulation of PPS-data.</p>
<div id="simulating-pps-data" class="section level2">
<h2>Simulating PPS data</h2>
<!-- 
export(simulate_incidence_stats)
export(simulate_incidence_stats_fast)
export(simulate_pps_data)
export(simulate_pps_fast)
-->
<div id="simulating-a-pps" class="section level3">
<h3>Simulating a PPS</h3>
<p>The function <code>simulate_pps_fast</code> can be used to generate PPS data. This functions simulates a PPS on the basis of a given prevalence <code>P</code> using a vector of probabilities <code>dist.X.loi</code> for the values 1:length(dist.X.loi) of <span class="math inline">\({{X}_{loi}}\)</span>. It directly samples the time of infection up to date based on <code>dist.X.loi</code>. Optionally, the length of stay is also sampled independently using <code>dist.X.los</code> which is in the same format as <code>dist.X.loi</code>. The sample is generated by treating the marginal distributions of length of stay and length of infection as independent by assumption. Because of this non-joint sampling rows should not be interpreted as individual patients.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example.dist &lt;-<span class="st"> </span><span class="kw">create_dist_vec</span>(<span class="cf">function</span>(x) <span class="kw">dpois</span>(x<span class="op">-</span><span class="dv">1</span>, <span class="dv">7</span>), <span class="dt">max.dist =</span> <span class="dv">70</span>)
example.dist.los &lt;-<span class="st"> </span><span class="kw">create_dist_vec</span>(<span class="cf">function</span>(x) <span class="kw">dpois</span>(x<span class="op">-</span><span class="dv">1</span>, <span class="dt">lambda =</span> <span class="dv">12</span>),
                                    <span class="dt">max.dist =</span> <span class="dv">70</span>)
data.pps.fast &lt;-<span class="st"> </span><span class="kw">simulate_pps_fast</span>(<span class="dt">n.sample=</span><span class="dv">5000</span>,
                               <span class="dt">P=</span><span class="fl">0.05</span>,
                               <span class="dt">dist.X.loi =</span> example.dist,
                               <span class="dt">dist.X.los =</span> example.dist.los)
<span class="kw">head</span>(data.pps.fast)</code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   A.loi L.loi A.los L.los patient.type
##   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;        &lt;dbl&gt;
## 1     0     0     2    17            1
## 2     0     0     2     8            1
## 3     0     0     5    12            1
## 4     0     0     5    13            1
## 5     0     0    19    23            1
## 6     0     0     5    10            1</code></pre>
<p>Values of zero for <code>A.loi</code> and <code>L.loi</code> indicate absence of a HAI.</p>
<p>The incidence rate per patient day <span class="math inline">\(I\)</span> and the expected length of infection in the whole population <span class="math inline">\({x_{loi}}\)</span> for a given distribution of <span class="math inline">\(X_{loi}\)</span> and given <span class="math inline">\(P\)</span> can be calculated with <code>simulate_incidence_stats_fast</code> by supplying a prevalence <code>P</code> and a vector of probabilities <code>dist.X.loi</code> for <span class="math inline">\({{X}_{loi}}\)</span>. Optionally one can also calculate <span class="math inline">\({I_{pp}}\)</span> and <span class="math inline">\({{x}_{los}}\)</span> if one supplies a vector of probabilites <code>dist.X.los</code> for <span class="math inline">\({{X}_{los}}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data.fast.inc.theo &lt;-<span class="st"> </span><span class="kw">simulate_incidence_stats_fast</span>(<span class="dt">P=</span><span class="fl">0.05</span>, 
                                                    <span class="dt">dist.X.loi =</span> example.dist,
                                                    <span class="dt">dist.X.los =</span> example.dist.los)
data.fast.inc.theo</code></pre></div>
<pre><code>## $x.loi
## [1] 8
## 
## $x.los
## [1] 13
## 
## $I
## [1] 0.006578947
## 
## $I.pp
## [1] 0.08125</code></pre>
</div>
</div>
<div id="extended-simulation-method" class="section level2">
<h2>Extended simulation method</h2>
<p>While the above method of simulation is fast and efficient and is useful for larger simulation studies, it is useful to have a more explicit simulation technique which samples from the joint distribution of <span class="math inline">\({{X}_{los}}\)</span> and <span class="math inline">\({{X}_{loi}}\)</span> and gives more control over subpopulations of patients.</p>
<p>The setup of this simulation model is described in the following.</p>
<div id="modelling-assumptions" class="section level3">
<h3>Modelling assumptions</h3>
<p>We assume the following setup. Patients arrive sequentially at a hospital X. A <code>hospital</code> is a named list with the following named elements:</p>
<ul>
<li>a general factor <code>inc.factor</code> which modifies the risk of nosocomial infections for all types of patients,</li>
<li>a list of patients <code>patient.list</code> characterized below,</li>
<li>a distribution of the patient types for the hospital given by <code>pat.dist</code> .</li>
</ul>
<p>A <code>patient.type</code> is a list with the following named elements</p>
<ul>
<li>a vector <code>dist.X.los</code> of probabilities for the values <code>1:length(dist.X.los)</code> of <span class="math inline">\({{X}_{los}}\)</span>.,</li>
<li>a vector <code>dist.X.loi</code> of probabilities for the values <code>1:length(dist.X.loi)</code> of <span class="math inline">\({{X}_{loi}}\)</span>.,</li>
<li>and the base incidence rate (per patient-day) <code>I.p</code> for this type of patient.</li>
</ul>
<p>The base-value of the length of stay is additive with the possible length of a nosocomial infection. Clustering of infections is not explicitly modelled.</p>
</div>
<div id="simulation-environment" class="section level3">
<h3>Simulation environment</h3>
<p>As an example we define a hospital with two different patient types.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pat.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">dist.X.los =</span> 
                <span class="kw">create_dist_vec</span>(<span class="cf">function</span>(x) <span class="kw">dpois</span>(x<span class="op">-</span><span class="dv">1</span>, <span class="dt">lambda =</span> <span class="dv">12</span>),
                                <span class="dv">70</span>),
              <span class="dt">I.p =</span> <span class="fl">0.008</span>,
              <span class="dt">dist.X.loi =</span> 
                <span class="kw">create_dist_vec</span>(<span class="cf">function</span>(x) <span class="kw">dpois</span>(x<span class="op">-</span><span class="dv">1</span>, <span class="dt">lambda =</span> <span class="dv">10</span>),
                                <span class="dv">70</span>))

pat.<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">dist.X.los =</span> 
                <span class="kw">create_dist_vec</span>(<span class="cf">function</span>(x) <span class="kw">dpois</span>(x<span class="op">-</span><span class="dv">1</span>, <span class="dt">lambda =</span> <span class="dv">10</span>),
                                <span class="dv">70</span>),
              <span class="dt">I.p =</span> <span class="fl">0.02</span>,
              <span class="dt">dist.X.loi =</span> 
                <span class="kw">create_dist_vec</span>(<span class="cf">function</span>(x) <span class="kw">dpois</span>(x<span class="op">-</span><span class="dv">1</span>, <span class="dt">lambda =</span> <span class="dv">7</span>),
                                <span class="dv">70</span>))

patient.list &lt;-<span class="st"> </span><span class="kw">list</span>(pat.<span class="dv">1</span>, pat.<span class="dv">2</span>)


<span class="co"># define distribution of patients</span>
pat.<span class="fl">1.</span>prob &lt;-<span class="st"> </span><span class="fl">0.4</span>; pat.<span class="fl">2.</span>prob &lt;-<span class="st"> </span><span class="fl">0.6</span>
pat.dist.hosp &lt;-<span class="st">  </span><span class="kw">c</span>(pat.<span class="fl">1.</span>prob, pat.<span class="fl">2.</span>prob)
hospital.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">inc.factor =</span> <span class="dv">1</span>,
                   <span class="dt">pat.dist =</span> pat.dist.hosp,
                   <span class="dt">patient.list =</span> patient.list)</code></pre></div>
<p>Using <code>simulate_pps_data</code> one can generate PPS data by simulating the evolution of <code>n.sample</code> beds for <code>steps</code> days.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data.pps &lt;-<span class="st"> </span><span class="kw">simulate_pps_data</span>(<span class="dt">n.sample=</span><span class="dv">5000</span>, 
                          <span class="dt">steps=</span><span class="dv">200</span>, 
                          <span class="dt">hospital=</span>hospital.<span class="dv">1</span>)
<span class="kw">head</span>(data.pps)</code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   A.loi A.los L.loi L.los patient.type
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;        &lt;int&gt;
## 1     0     6     0    10            1
## 2     0     7     0    10            2
## 3     0    10     0    11            1
## 4     0    11     0    14            2
## 5     9    16    11    21            1
## 6     0     4     0     8            1</code></pre>
<p>To get additional theoretical quantities based on the whole population, one can use <code>simulate_incidence_stats</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data.inc.theo &lt;-<span class="st"> </span><span class="kw">simulate_incidence_stats</span>(hospital.<span class="dv">1</span>, <span class="dv">365</span> <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>)
<span class="co"># gives incidence rate I</span>
data.inc.theo<span class="op">$</span>I</code></pre></div>
<pre><code>## [1] 0.01491682</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># gives incidence proportion per admission</span>
data.inc.theo<span class="op">$</span>I.pp</code></pre></div>
<pre><code>## [1] 0.1785913</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># average length of stay of patients who did not have a HAI</span>
data.inc.theo<span class="op">$</span>x.los.wo.noso</code></pre></div>
<pre><code>## [1] 11.97248</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># average length of stay of patients who had at least one HAI during their stay</span>
data.inc.theo<span class="op">$</span>x.los.only.noso</code></pre></div>
<pre><code>## [1] 17.78926</code></pre>
</div>
</div>
<div id="estimating-incidence-from-pps-data" class="section level2">
<h2>Estimating incidence from PPS data</h2>
<!--
export(calculate_I_smooth)
export(calculate_I_rhame)
export(calculate_I)
export(generate_I_fast)
-->
<div id="the-new-estimator" class="section level3">
<h3>The new estimator</h3>
<p>To use the newly proposed estimator <em>gren</em> presented in the companion paper, one can use the function <code>calculate_I_smooth</code> with <code>method=&quot;gren&quot;</code>. The <code>data</code> should be supplied as a data frame with at least a column named <code>A.loi</code> giving lengths of infection up to date of PPS. Values of zero for <code>A.loi</code> indicate absence of a HAI. Optionally, the data frame can also contain a column <code>A.los</code> supplying lengths of stay up to PPS to estimate <span class="math inline">\({{x}_{los}}\)</span> with the same method as well.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">calculate_I_smooth</span>(<span class="dt">data =</span> data.pps,
                  <span class="dt">method =</span> <span class="st">&quot;gren&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 1 x 8
##       n n.noso P.hat  I.hat I.pp.hat x.loi.hat x.los.hat method
##   &lt;int&gt;  &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
## 1  5000    529 0.106 0.0125    0.149      9.45      13.3 gren</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data.inc.theo<span class="op">$</span>I</code></pre></div>
<pre><code>## [1] 0.01491682</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">calculate_I_smooth</span>(<span class="dt">data =</span> data.pps.fast,
                  <span class="dt">method =</span> <span class="st">&quot;gren&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 1 x 8
##       n n.noso  P.hat   I.hat I.pp.hat x.loi.hat x.los.hat method
##   &lt;int&gt;  &lt;int&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
## 1  5000    242 0.0484 0.00652   0.0771      7.81      12.4 gren</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data.fast.inc.theo<span class="op">$</span>I</code></pre></div>
<pre><code>## [1] 0.006578947</code></pre>
<p>There is another variation of this estimator specified with <code>method = &quot;rear&quot;</code>. This uses the rearrangement estimator studied in <span class="citation">(Jankowski and Wellner 2009)</span> instead of the Grenander estimator as an estimator for the monotonously decreasing distribution of <span class="math inline">\({{A}_{loi}}\)</span> and <span class="math inline">\({{A}_{los}}\)</span>. We will denote this type of estimator by <em>rear</em>.</p>
</div>
<div id="confidence-intervals-for-the-new-estimator" class="section level3">
<h3>Confidence intervals for the new estimator</h3>
<p>There are two helper functions to calculate confidence intervals for the estimates of <span class="math inline">\({I_{pp}}\)</span> with the <em>gren</em> estimator: One ( <code>calculate_CI_I_pp</code>) is based on the typical output of <code>calculate_I_smooth</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gren_est &lt;-<span class="st"> </span><span class="kw">calculate_I_smooth</span>(<span class="dt">data =</span> data.pps.fast, <span class="dt">method =</span> <span class="st">&quot;gren&quot;</span>)
gren_est</code></pre></div>
<pre><code>## # A tibble: 1 x 8
##       n n.noso  P.hat   I.hat I.pp.hat x.loi.hat x.los.hat method
##   &lt;int&gt;  &lt;int&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
## 1  5000    242 0.0484 0.00652   0.0771      7.81      12.4 gren</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">calculate_CI_I_pp</span>(gren_est, <span class="dt">method =</span> <span class="st">&quot;asymptotic&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.05</span>)</code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   CI.lower.Ipp CI.upper.Ipp
##          &lt;dbl&gt;        &lt;dbl&gt;
## 1       0.0491        0.105</code></pre>
<p>The other (<code>CI_np_bs</code>) is based on a bootstrapping approach which resamples from the estimates of the distributions for <span class="math inline">\({{A}_{loi}}\)</span> and <span class="math inline">\(Alos\)</span> based on the Grenander estimator. It works with data as output by <code>simulate_pps_data*</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">CI_np_bs</span>(data.pps.fast)</code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   CI.lower.Ipp CI.upper.Ipp
##          &lt;dbl&gt;        &lt;dbl&gt;
## 1       0.0655        0.106</code></pre>
</div>
<div id="other-estimators" class="section level3">
<h3>Other estimators</h3>
<p>The function <code>calculate_I_rhame</code> can be used to calculate the incidence with a user-supplied value <code>x.loi.hat</code> for the estimated length of infection <span class="math inline">\({x_{loi}}\)</span> and an optional specification of <code>x.los.hat</code> for the estimated length of stay <span class="math inline">\({{x}_{los}}\)</span> to get an estimate of <span class="math inline">\({I_{pp}}\)</span> too. Here we take the example of an estimator where <code>x.loi.hat</code> and <code>x.los.hat</code> are fixed to their theoretical values and which depends only on the estimate of <span class="math inline">\({P}\)</span>. We will call this type of estimator <em>rhame.theo</em> .</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">calculate_I_rhame</span>(data.pps,
                  <span class="dt">x.loi.hat =</span> data.inc.theo<span class="op">$</span>x.loi,
                  <span class="dt">x.los.hat =</span> data.inc.theo<span class="op">$</span>x.los,
                  <span class="dt">method =</span> <span class="st">&quot;method identifier&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 1 x 8
##       n n.noso P.hat  I.hat I.pp.hat x.loi.hat x.los.hat method           
##   &lt;int&gt;  &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;            
## 1  5000    529 0.106 0.0135    0.163      8.77      13.5 method identifier</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data.inc.theo<span class="op">$</span>I</code></pre></div>
<pre><code>## [1] 0.01491682</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data.inc.theo<span class="op">$</span>I.pp</code></pre></div>
<pre><code>## [1] 0.1785913</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">calculate_I_rhame</span>(data.pps.fast,
                  <span class="dt">x.loi.hat =</span> data.fast.inc.theo<span class="op">$</span>x.loi,
                  <span class="dt">x.los.hat =</span> data.fast.inc.theo<span class="op">$</span>x.los,
                  <span class="dt">method =</span> <span class="st">&quot;method identifier&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 1 x 8
##       n n.noso  P.hat   I.hat I.pp.hat x.loi.hat x.los.hat method          
##   &lt;int&gt;  &lt;int&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;           
## 1  5000    242 0.0484 0.00636   0.0786         8        13 method identifi~</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data.fast.inc.theo<span class="op">$</span>I</code></pre></div>
<pre><code>## [1] 0.006578947</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data.fast.inc.theo<span class="op">$</span>I.pp</code></pre></div>
<pre><code>## [1] 0.08125</code></pre>
<p>As a convenience function, one can use <code>calculate_I</code> to get estimates of I for a range of estimators (including the ones studied in <span class="citation">(Willrich et al. 2019)</span>) based on PPS data and the accompanying theoretical data .</p>
<p>The estimators are the following:</p>
<ul>
<li><em>gren</em> - new method using Grenander estimator,</li>
<li><em>rear</em> - new method using rearrangement estimator,</li>
<li><em>pps.mixed</em> - mixed estimator described in the paper,</li>
<li><em>pps.median</em> - estimator based on the median duration up to PPS (used in <span class="citation">(European Centre for Disease Prevention and Control 2013)</span> ),</li>
<li><em>pps.mean</em> - alternative estimator used in <span class="citation">(European Centre for Disease Prevention and Control 2013)</span> based on the mean instead of the median</li>
<li><em>L.full</em> - estimator based on samples from the PPS with information on full length of stay/infection.</li>
<li><em>rhame.theo</em> - estimator using theoretical values for x.loi/x.los.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">calculate_I</span>(data.pps.fast, data.fast.inc.theo)</code></pre></div>
<pre><code>## # A tibble: 8 x 8
##       n n.noso  P.hat   I.hat I.pp.hat x.loi.hat x.los.hat method    
##   &lt;int&gt;  &lt;int&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     
## 1  5000    242 0.0484 0.00652   0.0771      7.81     12.4  gren      
## 2  5000    242 0.0484 0.00778   0.0894      6.54     12.1  rear      
## 3  5000    242 0.0484 0.00971   0.115       5.24     12.4  pps.mixed 
## 4  5000    242 0.0484 0.0102    0.0678      5         7    pps.median
## 5  5000    242 0.0484 0.0101    0.0706      5.05      7.36 pps.mean  
## 6  5000    242 0.0484 0.00619   0.0764      8.21     13.0  L.full    
## 7  5000    242 0.0484 0.00636   0.0786      8        13    rhame.theo
## 8  5000    242 0.0484 0.00546   0.0667      9.31     12.8  naive</code></pre>
<p>If one wants to combine the (fast) simulation step with the estimation step one can use <code>generate_I_fast</code>. This is just a wrapper for first calling <code>simulate_pps_fast</code> and then calling <code>calculate_I</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">generate_I_fast</span>(<span class="dt">n.sample =</span> <span class="dv">10000</span>,
                <span class="dt">P =</span> <span class="fl">0.05</span>,
                <span class="dt">dist.X.loi =</span> example.dist,
                <span class="dt">data.theo =</span> data.fast.inc.theo)</code></pre></div>
<pre><code>## # A tibble: 8 x 8
##       n n.noso  P.hat   I.hat I.pp.hat x.loi.hat x.los.hat method    
##   &lt;int&gt;  &lt;int&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     
## 1 10000    489 0.0489 0.00820  NA           6.27        NA gren      
## 2 10000    489 0.0489 0.00820  NA           6.27        NA rear      
## 3 10000    489 0.0489 0.00935  NA           5.50        NA pps.mixed 
## 4 10000    489 0.0489 0.0103   NA           5           NA pps.median
## 5 10000    489 0.0489 0.0107   NA           4.81        NA pps.mean  
## 6 10000    489 0.0489 0.00648  NA           7.94        NA L.full    
## 7 10000    489 0.0489 0.00643   0.0795      8           13 rhame.theo
## 8 10000    489 0.0489 0.00820  NA           6.27        NA naive</code></pre>
</div>
</div>
<div id="helper-functions" class="section level2">
<h2>Helper functions</h2>
<!--
export(epmf)
export(length_biased_dist)
export(length_unbiased_mean)
export(monotone_smoother)
export(A_to_X_dist)
export(X_to_A_dist)
-->
<p>The function <code>monotone_smoother</code> implements the rearrangement estimator and Grenander estimator described in <span class="citation">(Jankowski and Wellner 2009)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">A.loi.sample &lt;-<span class="st"> </span>data.pps<span class="op">$</span>A.loi[data.pps<span class="op">$</span>A.loi<span class="op">&gt;</span><span class="dv">0</span>]
<span class="co"># raw histogram of data</span>
<span class="kw">hist</span>(A.loi.sample)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">A.loi.smoothed &lt;-<span class="st"> </span><span class="kw">monotone_smoother</span>(A.loi.sample, <span class="dt">method =</span> <span class="st">&quot;gren&quot;</span>)
<span class="co"># estimated monotonously decreasing distribution</span>
<span class="kw">plot</span>(A.loi.smoothed)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAEgCAMAAABb4lATAAAAXVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmZmZmtrZmtv+QOgCQOmaQkGaQ2/+2ZgC2Zma2/7a2///bkDrb/9vb////tmb/25D//7b//9v///8k+7IMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAISklEQVR4nO2di3biNhRFyWvaMG3Sxm3oAMn/f2aRbJIZHLB9rWuko73XatMyiqTxRu+HV+8gzeraGQBfECwOgsVBsDgIFgfB4iBYHASLg2BxECwOgsVBsDgIFgfB4iBYHASLg2BxECwOgsVBsDgIFgfB4iBYHASLg2BxECwOgsVBsDgIFgfB4iBYHASLg2BxECwOgsVBsDgIFgfB4iBYHASLg2BxECwOgsVBsDgIFgfB4iBYHASLg2BxECwOgsVBsDgIFgfB4iBYHASLg2BxECwOgsVBsDgIFgfB4iBYHASLg2BxECwOgsVBsDgIFgfB4iBYHASLg2BxECwOgsVBsDgIFiex4BUsxLUEn9g++dNevixB4H2CN0fBq9Poex+YgkAgA8GrwQ9MQSAyUfB+/Vm5376mSRfBnhhK8Hb1GP5985IoXQR7Ml3w2/N9/Lm5+5EoXdpgR6YL3q+f4s9tqiqaXrQnlhL8GH82yUowOGJqg0MR3iRrg/2gTNuGSbErbSu/0ydYZkCr/J7FONgL+tWBugRXWGcbq+i7H83jMunOTeLieKwCLJ2sm5fDGHi/nmX4Gm1wlXW2bZgUJjk26cbBXpzUyAgeFTBMdATBCSc6FgLBowIeS3CBEx20waMCtm3wZvW0SLpJoRc9KmCc6Jg3kVVdQboawuNgCCBYHIPgt+e0OzrAE4PgZpbZqenCPCzj4HmTlBPTdUa+X23f0bFQur7oj4zte7IWSteVCua2DG3w7iFBEc7joSL4NKDHvugrgmBDwKtEZ4U2uB9w/72dpDStJi26J2sM+eTECbvgAtaDYbrg5rMMZr+jA97nlOCF0l0atTq78k5WD7lel0Xw7mFwPTjMV4dgZ0Nl+hD1xk2moyuh9b24oyP6/fZyYV4z02eI4M/DZxeOj8b1iOb+UqhMnyGCRx0fDUG678G5ULk+Q9rgMSU4lt5NiSWYXvT7qDZ4v759jV+Esxc9aD3FjHHqRR++BZGzK4sIXgjGweIgWBynKnpw5yWCF8Knk7U5rkRszy1JIHghXIZJxyAXQiF4IdwmOjpKm+iQgxIsjlcb/PRz2J9iyW3LjjxOvejj7suzpRzBC8E4WBwEi2MQfKx+R+2qPLf3EsELYelFz7p9ZWq6MI/KTxfqYx8HL5QuzMNyuvDb8MZoFhtywXR8dLCTxWJDNrgcAGeqMh9cOlksNuSDSyeLEpwPPp2ss4sN09OFeViq6BFXOLDYkAvMRQ9S9tomgoco/DCLabHh8dDIGl+cNDnda1P6cTSD4Obux+7hvjs96J7utalPcBjkhrfblffOBhN1Cg4HvE237BS4J6u+Nri536/De5PqqKIr7EUfxrg3L3OvJC35mRUFwyRxECyOXTBXGRYBJVgcBIuD4OkUNW5C8GTKmvmYKHi/fhy1Hpwu3ewobO6SEjwVBF8jugX5SnDGrbLT+eB06eZHvw3OuVX2OeGfMN0MOS2vWVfa9m2zly4jTZhuAYgJHnHLTsp0C0BMMCW4B23wjHSLgF70RyzlbdkpHMbB4iBYHASLM3mxQer9wRVACRbHSTCXsOSCz6Y7LmHJBpcSzBUO+Ux9uAjmEpYvlhR7xpf5DtgFv/11toquvgT3lx+utohsFbwZuAit7ktYeoK/Nr7EYzAJ3nLj+2WKFty6m3shqbbgXv1bjuAmvnEyvgF6mXQL5attPSW0wV3/eFAwEx2nlNKL3o4qwUx0WBjzHeh9MhTE0MlqBtvg6odJJsbU4r1PBoOYetGhn3WpF81Eh4Ex/TBD79w6Dt5eGgdTgg1kJvjAP4aJDvZknSU/wZeofKLDREZtcAIQ3CeXXnQSELwQ3oLPvtoOFsJZ8JJ4ZbGOeBEsHi+CxeOd9luDiw0e5PXASot30m8NLzZ4kNcDKy3eKb81YqrSg7weWGnxTvmtEYsNHuT1wEqLlxIsHu/ENnhoV6UHeT2w0uJNvNgAuVHAOBjmgGBxECwOgsVBsDgIFgfB4iBYHASLg2BxECwOgsXJXHC7ujHvncZfsPstLmdvZ7+E5Mt4E2c67pOKq3eW/GYuePctqYCO/TruV9gentY2peEu3rSZfns+ZHETvi+m/GYu2GXnSHeEst2/0KSrHo5HM9NmevcQFuE3t6+2/GYueJO8do67FaKCjyeXOF6fTN+82PKbueDm99X8q3/6tIJjTZq0uLWReWS6uX215Tdvwft12DvSJDccn1LbnCVthGO8HpkOe6Rs+c1bcEv6hthVcO8/E8R77GNpCm4bn5T4VtGRlJlu9zgqVtEt6cdKLp2s918Fp8t0d6BEsZPV/p2cqujkw6RfvjjpMn3crCw5TIp/HadOVvqJjmMvOmmmdw/HmBQnOuL1bKlb4I/itUk9VdnFmzTTm3YresioJb+5C4aZIFgcBIuDYHEQLA6CxUGwOAgWB8HiIFgcBIuDYHEQLA6CxUGwOAgWB8HiIFgcBIuDYHEQLA6CxUGwOAgWB8HiIFgcBItTn+De8a20589yA8EIFgPB4hx87td/rtsDnuFA5t/dycxwjj6cn9+vF3wplDuVCg6Xxx3+aQ4+t6vuf8JJ63CKfsm3uvlTqeDHeNNCe9lC030Qj29vb//9LlVjVyr4Kb5q8+Mmh7YZjr6b9FefXpWqBW8+BLfXJIRmeetwY8Q1qVrwSQkOvD3/sejrzd2pWnB381T3QWRz99+zUie6bsGx8/zRi257W0+Lvvzan7oF/zoOPohtDkOkt2elblZ9gisDweIgWBwEi4NgcRAsDoLFQbA4CBYHweIgWBwEi4NgcRAsDoLFQbA4CBYHweIgWBwEi4NgcRAsDoLFQbA4/wPtqEqcBAQiKAAAAABJRU5ErkJggg==" /><!-- --></p>
<p>For creating length-biased distributions there is <code>length_biased_dist</code>, which takes a vector of probabilities of a discrete positive distribution as an argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># geometric distribution starting in 1 and cutoff at 70 with mean at about 8.</span>
geom.dist &lt;-<span class="st"> </span><span class="kw">create_dist_vec</span>(geom_dist_fct, <span class="dt">max.dist =</span> <span class="dv">70</span>)
<span class="co"># calculate mean</span>
<span class="kw">sum</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(geom.dist)<span class="op">*</span>geom.dist)</code></pre></div>
<pre><code>## [1] 7.993895</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot original distribution</span>
<span class="kw">plot</span>(geom.dist)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geom.dist.lb &lt;-<span class="st"> </span><span class="kw">length_biased_dist</span>(geom.dist)
<span class="co"># plot length biased distribution</span>
<span class="kw">plot</span>(geom.dist.lb)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAEgCAMAAABb4lATAAAAYFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmADpmZmZmtrZmtv+QOgCQZgCQkGaQ2/+2ZgC2/7a2///bkDrb2//b/9vb////tmb/25D//7b//9v///9cgaDyAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKtUlEQVR4nO2dgXbbJhSGlSbpNrtbskWttiiO3v8tJ0CSLcWy7kUg4Z//OyfNaQsG6/MFBAgXDYGm2LsCJC4UDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOIEFF2Qj9hIsT9nWUVFPMiZ5wcXFD9GzsWBdy9GlK5xhhrEPKUfwOXgZxt4kLNgmMVFrBbvwpWEtqQueBC/baS3pC+5G0WPdREqqgq3WUbqLMA5bFWwSFdyNrUbt8TmM2U7LSVPwXKSynVZzX4LZTqu5M8Hj4RZZJk3BN1thCtbgI/h0bMPo8T1qubfGUddGYGQGD8F18dL+WT28bVLu1cxf7qHIHHrBn68H+7tcFcNr3bCdFqIXfDq+2N/1t19xyhW1vRQsxCeCn+zvKlIEy9peChbi1QebNrqO1AdLzXGkJUMp2A6gO+I00eLQ5EhLRHL3wZq2l+30MskJ1kQlBS+TnmBFv0rBy2zcB+u36y5WiiOtmyQYwaqX4UhrgTsX3LCdXsBfcBVrJsvrlSh4BkYwOGkJ9houFQ23ac3jsdjww81RRlhs8BwuDU+4kK/4C17ug+uimJ2wvrodR1ejIDnh0Qouz3eyhxup22SHjz/eh7VFUbkUHAH/CL6F2QxQ2uidW1Sk4I2IMsiycfvx3Qie66lD9sFDTo60vuIh+HQ8NNXNXXcmRdN8/tvoIthzFD3k5EjrCh6C2/b34/mpKZ/mEw8DMKd6Tbly2E5fw29PltlYefM2qdtz6TZgripXDgVfw09w2cpNZapy8pIUPManiX46HR/fT8cbTXTAcpWvyZHWBK9BVvHw1u+tnOHzdWHNOIoEjrS+EmcuuupnQeq56ZBYDthOT4giuH/4odHeJq2HgifEm+hwqCY6AkDBE9R7sg7Dtqz5UfSOEcyR1oRYfXAXwtM+OPCmu2twpDUi0oJ/H+az85lRLz/b6TMbb5udLzdkUFPwGY8IjvLwWdBGtRPMjrjxEax7fHRuQrO49teghrmNx+I3F20IuicrdKPKw3h6fCI4whEOEWxQsMWrD45wCEv49pSCLT63SYJjlPSLDeFHRJzyMKAtNozK4JQH3mLD1WJyNuwv+MaOjh0XG64WQ8EhEzYJRnDG/fDGiw1+L7eC4uInSyAXG0YFZT7j4bcnK+I5WeGhYF3Cz9eVJwnryg1VVK5LD/5z0RuVG6isbJce/OeiNyo3BDkvPXj0we6xwa3KDQQFyxN+PN/XIOuivAw7Yv8Ff7/i4m+6myu5ybMjzmGQ1ZWYZ0ecxSBrXGhe7XQug6yLQvNqp32a6Kgnvkfl7DYbw5Hmord+OXGxQ0ecSzudhOBNL3Zm7bSPYHsjvG7P3ajcjS92Xu20165KM4yuZs9X0Za7+cXOqp32v00K9sVYe0RTPu20/0RHsCcbdmkus2mnE4jgfQIpl3Y6gT54t01xWbTTKYyidyOHdjqJ++DduGynd65KLPIW3HQVMXqTqVFYfASfjsXje7luTSmdy1l068Sgoy2fQdbDW2XOqlxlOKFLeblOnFC1AuF3m2RukZI7bdafoZkGDGO/iQ4jOMLX6uzGeDidVt1W4h/BQY9w2Js+cPHC2LsP9pvo2G/T3TKYYew5isaY6JgAGcbZ3wdPgAtjCp6AFsY+o+ihH12x3JD0ZZuE8V1L9l5NqouXNXMdaV+yURi7ecx7texzmzScVbliSTj9q1UMP0Vzxz3yqh0d83Md+3zrSli6MC7ue7Z61Y6O2dnKNA5CC0Bx0UwPAX1Xltf0wbPPGaZzjNJqhjBu7tSy90RHG7zlXACncxBaEEZHIk4tp246yn0wUAQPfBlYj4Zh6VqOM9GRzkFoQRmHcXf71IwsJ6c60kxWOgehBeVLY305xG568UlZ5lSlmkvLZ8HXB9v799IU7MfYcjNj+Vr7vbHvSIIRJjqW6eNzzvKkl5424kN4x7Qfa5AFMtEhZLA8Mwy7Hd6z9mc/Asv/ea6a+D0o3i/ibdIy56veXB2GzYX3vP25j8Dyf17USlx9xVsFm+hQ8yWgb7bf8/p8Ph/nD0lXF3GlFW8wzwieMGpGrwTYPQve9etl02TSdTa3+uAmfcGoEx3BuDVKuoM+ePuXgyL9UfT2L0fmiC149utlyUZEFhz8ddX1iF1AchXyVEXBgdKnV8CaXOFfN7nrmVyFNhG8uNjgXZvkrmdyFdpC8PJig3dtkrueyVVoA8GCqUrv2iR3PZOr0AaCBYsN3rVJ7nomVyFG8L7p0yvAI9fyrkrv2iR3PZOr0Caj6MXFBpIanDwGh4LBoWBwKBgcCgaHgsGhYHAoGBwKBoeCwaFgcCgYnCiCa9WxxB+//VJksruGDooMVZ9MXit3KLowvVuAeZJnMN9P9SSvUN3tk33RXldHDMF1W4taXJPT0W4eEGb6fG3TVOYCCTOYHdw2mbxWtV0tk6b/+N6lEWao2xc/HeVvwKLOMBBBsNsXUM6cpjaldlv4pJk+ns2SdGtNmMGerGqOdpPXyn69kDx9v7lFmMElk78Bh/mY6q5rTwTBgwNJ4ro42CukymQ+x5oMRrA8ffX4dytYnL7qrrgwwxDwmjfw8XzQXqKeGILtW5B/e4sTrMpUfvulyVC17Zo4fZvQ9MHi9OXvblAgzFB/+3nUpHdl6C9RTwTBrpuQdxa2yqpMZseQPENtr6c0vWkIjWBp+tPRdNiluEJVYVvbJ807did4a6+r4x4F1/0YS5rh8/XxXZq+/2oh3bswhzALBT+8qdI3zfi9JiA4dhPtdvypSjF9tiy9TaZqol225xdhBteHytMb3G1bMk20djCgHGR1j1eoSjHXU5a+6u86de+ivfjCDE6QPH3Tt9DpDLK0w/lac5s0bN0VZnBXpdbdlZSK2yRtAe7pAVWFXBHp3CZpb8hrzUSHvWHQlDLIUtSq1Ex02Cteyguo1BXqE6Uy0XExOyii61Vkmbom1KQUllIW3RcFyWvl+jxpem0BdT/XKi1gaJV119XBxQZwKBgcCgaHgsGhYHAoGBwKBoeCwaFgcCgYHAoGh4LBoWBwKBgcCgaHgsGhYHAoGBwKBoeCwaFgcCgYHAoGh4LBoWBwKBgcCgYnP8FfHt9SP891V1AwBYNBweC0Pk/Hv47ukU/zQOY/3bOo5plO86Rm90A9CJkKNsfltT/meKK66P5ini03T2YvfqvbXZGp4MPFuR1l9w/2SfT6288fUC12poJf7GEZw+ERrhu2vstCeQhG4mQtuBoEX57o+rL4EvdE1oInEWz4fP1TeU5R4mQtuDt5qvsHS/X43yvSIDpvwXbwPIyi3WjrRX2WXNrkLXh8H9yKdadqIQ2z8hOcGRQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4PwPHSzmFJqOcKkAAAAASUVORK5CYII=" /><!-- --></p>
<p>To calculate the mean of the original distribution based on the length-biased distribution one can use <code>length_unbiased_mean</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># length biased distribution from chunk above</span>
<span class="kw">length_unbiased_mean</span>(geom.dist.lb)</code></pre></div>
<pre><code>## [1] 7.993895</code></pre>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-surveyecdc">
<p>European Centre for Disease Prevention and Control. 2013. Point Prevalence Survey of Healthcare-Associated Infections and Antimicrobial Use in European Acute Care Hospitals 2011-2012. Stockholm: ECDC.</p>
</div>
<div id="ref-freeman1980">
<p>Freeman, Jonathan, and George B. Hutchison. 1980. Prevalence, Incidence and Duration. <em>American Journal of Epidemiology</em> 112 (5): 70723.</p>
</div>
<div id="ref-jankowski2009">
<p>Jankowski, Hanna K., and Jon A. Wellner. 2009. Estimation of a Discrete Monotone Distribution. <em>Electron. J. Statist.</em> 3: 15671605.</p>
</div>
<div id="ref-rhame">
<p>Rhame, Frank S., and William D. Sudderth. 1981. Incidence and Prevalence as Used in the Analysis of the Occurence of Nosocomial Infections. <em>American Journal of Epidemiology</em> 113 (1): 111.</p>
</div>
<div id="ref-willrich2019">
<p>Willrich, Niklas, Sebastian Haller, Tim Eckmanns, Benedikt Zacher, Tommi Karki, Diamantis Plachouras, Alessandro Cassini, et al. 2019. From Prevalence to Incidence - a New Approach in the Hospital Setting. <em>bioRxiv</em>. Cold Spring Harbor Laboratory. doi:<a href="https://doi.org/10.1101/554725">10.1101/554725</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
